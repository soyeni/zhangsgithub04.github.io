<!DOCTYPE html>
<html lang="en">
<head>
    <title>Babylon.js Chessboard with Colored Rooks</title>
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
</head>
<body>
    <canvas id="renderCanvas" style="width: 100%; height: 100%;"></canvas>
    <script>
        const canvas = document.getElementById("renderCanvas");
        const engine = new BABYLON.Engine(canvas, true);

        const createScene = () => {
            const scene = new BABYLON.Scene(engine);

            // Camera
            const camera = new BABYLON.ArcRotateCamera("camera", -Math.PI / 2, Math.PI / 2.5, 15, BABYLON.Vector3.Zero(), scene);
            camera.attachControl(canvas, true);

            // Light
            new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0), scene);

            return scene;
        };

        const scene = createScene();

        const createPiece = (modelPath, position, color) => {
            return new Promise((resolve) => {
                BABYLON.SceneLoader.Append("", modelPath, scene, (newMeshes) => {
                    const piece = newMeshes[0];
                    piece.position = position;

                    // Set initial color
                    const pieceMaterial = new BABYLON.StandardMaterial("pieceMat", scene);
                    pieceMaterial.diffuseColor = color; // Set the color
                    piece.material = pieceMaterial;

                    resolve(piece); // Resolve the promise with the piece
                });
            });
        };

        // Load two different rooks with different colors
        Promise.all([
            createPiece("rook.glb", new BABYLON.Vector3(-3.5, 0.5, 3.5), new BABYLON.Color3(1, 0, 0)), // Red rook
            createPiece("rook.glb", new BABYLON.Vector3(3.5, 0.5, 3.5), new BABYLON.Color3(0, 0, 1))  // Blue rook
        ]).then((pieces) => {
            console.log("Rooks loaded:", pieces);
        });

        engine.runRenderLoop(() => {
            scene.render();
        });

        window.addEventListener("resize", () => {
            engine.resize();
        });
    </script>
</body>
</html>
